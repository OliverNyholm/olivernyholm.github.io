<!DOCTYPE html>
<html lang="en">

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Oliver Nyholm</title>
    <link rel="shortcut icon" href="img/titleImage.png" type="image/png">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/business-casual.css" rel="stylesheet">
    <link href="css/modal.css" rel="stylesheet">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Josefin+Slab:100,300,400,600,700,100italic,300italic,400italic,600italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div class="brand">Oliver Nyholm</div>
    <div class="address-bar">AI and Gameplay Programmer</div>

    <!-- Navigation -->
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <!-- navbar-brand is hidden on larger screens, but visible when the menu is collapsed -->
                <a class="navbar-brand" href="index.html">Behaviour Tree</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <li>
                        <a href="games.html">Games</a>
                    </li>
                    <li>
                        <a href="contact.html">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <div class="container">

        <div class="row">
            <div class="box">
                <div class="col-lg-12">
                    <hr>
                    <h2 class="intro-text text-center">
                        <strong>Behaviour Tree</strong>
                    </h2>
                    <hr>
                </div>
                <div class="col-lg-6">       
                    <img class="img-responsive img-border" id="img-popup" src="img/behaviourTree/patroller.gif" alt="An AI patrolling between waypoints, visualized with the pink connections.">                    
                </div>
                <div class="col-lg-6">
                    <h2 class="intro-text text-center">
                        <strong>Summary</strong>
                    </h2>
                    <hr>
                    <p>
                        During the school's AI course, we received a behaviour tree base project for an assignment to implement an AI with. I used this base code
                        for the AI in project 6, but it was difficult to build and visualize in code. <br/>
                        So in project 7, I modified our script editor to support my own script nodes
                        that would be used to create behaviour trees. The final result can be seen in the gif, where I also networked a communication between the editor 
                        and the engine, allowing me to visualize the flow in the behaviour tree. Much like Unreal does.
                    </p>        
                </div>
                <div class="col-lg-12">
                    <br/>
                    <h2 class="intro-text text-center">
                        <strong>About</strong>
                    </h2>
                    <hr>
                </div>
                <div class="col-lg-6">
                    <p>
                        The AI characters in the <a href="ragnarsmjod.html">6th project</a> and the 7th project all used behaviour trees to do their game logic.
                        <i>Spite - Ragnars Mjöd</i> was the first project that used behaviour tree and it was all done in code. To visualize the behaviour tree, 
                        I drew all logic in <b>Paint</b> (Ouch!). This was tedious, since when I wanted to change the tree, I had to draw around in paint as well.
                    </p>
                    <p>
                        During the 6th project, we implemented a visual script editor that was part of an assignment. And as we started our 7th project, I wanted to
                        implement support to create my behaviour trees in it as well. This would increase the speed of which I can work with the AI, and it would also
                        allow me to let designers tweak behaviours as well. During <b>pre-production</b>, it was implemented and upp and running!
                    </p>
                </div>
                <div class="col-lg-6">
                    <img class="img-responsive img-border" id="img-popup" src="img/behaviourTree/BTDraugr.png" alt="Behaviour Tree in Project 6. Paint &lt;3 ">
                </div>
                <div class="col-lg-12">
                    <hr>
                    <img class="img-responsive img-border" src="img/behaviourTree/terroristBT.png" alt="">                    
                    <p>
                        After the 7th project's <b>alpha sprint</b>, I was inspired to visualize the AI characters in the editor, 
                        much how Unreal Engine does with their behaviour trees.
                        So after the first of two <b>beta</b> sprints, I added the possibility to visualize what the AI was doing in the editor.
                    </p>
                </div>
                <div class="col-lg-6">
                    <p>
                        The solution to do it was by sending networked messages to the script editor from the engine. The Editor exports out the nodes ID,
                        which I mapped to the behaviour nodes in engine. When they were triggered, I sent a network message with the ID of the node.
                        If the editor has a matching node, I set a count of 60 onto that script node, that counts down everytime the window is repainted.
                        The function is recursive, setting all the connected nodes count as well. Then with the count, I lerp the color and size so it is 
                        easier to visualize the flow.
                    </p>
                    <p>
                        I made the connection UDP, in order for both clients to be opened and closed whenever, ignoring required handshakes and sending
                        messages back and forth.
                    </p>
                </div>
                <div class="col-lg-6">
                    <img class="img-responsive img-border" id="img-popup" src="img/behaviourTree/editorNetwork.png" alt="Network in Script Editor">
                </div>
                <div class="col-lg-12">
                    <br/>
                    <h2 class="intro-text text-center">
                        <strong>Creating Nodes</strong>
                    </h2>
                    <hr>
                    <p>
                        Our script editor worked with Squirrel as programming language in the background, that then communicated to C++. To create a 
                        Behaviour Tree node, I first create a <i>.nut</i> file that would work as a node in the script editor. The nut file had two functions;
                        holding a name and calling a function in the C++ Engine. The function in the C++ engine would collect the nodes arguments
                        and send a message to the <b>Behaviour Tree Factory</b>, telling it to create a node.
                    </p>
                    <p>
                        The Behaviour Tree Factory was a class that would create and store "blueprints" of all the behaviour trees created in the script editor.
                        At engine startup, the factory would read all the behaviour tree .xml files that the editor had created.
                        The .xml files were scripts that would start at the root node and parse through all connections. The factory would start the scripts, 
                        and then collect all the messages from the node scripts, and add them to the current tree in creation.<br/>
                        Our scripting system was covered with wrapped layers, not exposing squirrel to the rest of the engine. As I wanted to continue with this philosophy,
                        I had to keep the C++ bridge functions behind the wrapped layers and send messages for which nodes should be created and their data needed.
                        I wanted to actually work on AI as well and not just a cool editor, I resolved with a quick and dirty switch case to check which 
                        node was to be created.
                    </p>
                </div>
                <div class="col-lg-4">
                    <img class="img-responsive img-border" id="img-popup" src="img/behaviourTree/nutFolder.png" alt="Folder with a few of the nut-files read by the script editor">
                </div>
                <div class="col-lg-4">
                    <img class="img-responsive img-border" id="img-popup" src="img/behaviourTree/nutCode.png" alt="The Nut file for Spawning Enemies (Used by boss)">
                </div>
                <div class="col-lg-4">
                    <img class="img-responsive img-border" id="img-popup" src="img/behaviourTree/loadingNode.png" alt="Loading nodes in Behaviour Tree Factory">
                </div>
            </div>
        </div>
    <div class="clearfix"></div>
    </div>
    <!-- /.container -->

    <!-- Model Code for cool images-->
    <div id="myModal" class="modal">
        <img class="modal-content" id="popupImage">
        <div id="caption"></div>
    </div>
    <script src="js/modal.js"></script>
    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
